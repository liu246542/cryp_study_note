



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>匿名凭证 - My Notes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../css/mystyle.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#anonymous-crendials" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="My Notes" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              My Notes
            </span>
            <span class="md-header-nav__topic">
              匿名凭证
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="My Notes" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    My Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      密码学
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        密码学
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      数字签名
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        数字签名
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../blind/" title="盲签名" class="md-nav__link">
      盲签名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../group/" title="群签名" class="md-nav__link">
      群签名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ring/" title="环签名" class="md-nav__link">
      环签名
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        匿名凭证
      </label>
    
    <a href="./" title="匿名凭证" class="md-nav__link md-nav__link--active">
      匿名凭证
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" title="1. 由来" class="md-nav__link">
    1. 由来
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2 构造" class="md-nav__link">
    2 构造
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-cl-2001" title="2.1 CL 2001" class="md-nav__link">
    2.1 CL 2001
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2" title="Step2. 生成假名" class="md-nav__link">
    Step2. 生成假名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3" title="Step3. 生成凭证" class="md-nav__link">
    Step3. 生成凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4" title="Step4. 使用凭证" class="md-nav__link">
    Step4. 使用凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step5" title="Step5. 证明其是某个凭证的拥有者" class="md-nav__link">
    Step5. 证明其是某个凭证的拥有者
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-blanton-2008" title="3. Blanton 2008" class="md-nav__link">
    3. Blanton 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1_1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-subscribe" title="Step2. 订阅 (Subscribe)" class="md-nav__link">
    Step2. 订阅 (Subscribe)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3-access" title="Step3. 访问 (Access)" class="md-nav__link">
    Step3. 访问 (Access)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" title="总结" class="md-nav__link">
    总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#amo-2008" title="AMO 2008" class="md-nav__link">
    AMO 2008
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" title="1. 由来" class="md-nav__link">
    1. 由来
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2 构造" class="md-nav__link">
    2 构造
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-cl-2001" title="2.1 CL 2001" class="md-nav__link">
    2.1 CL 2001
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2" title="Step2. 生成假名" class="md-nav__link">
    Step2. 生成假名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3" title="Step3. 生成凭证" class="md-nav__link">
    Step3. 生成凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4" title="Step4. 使用凭证" class="md-nav__link">
    Step4. 使用凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step5" title="Step5. 证明其是某个凭证的拥有者" class="md-nav__link">
    Step5. 证明其是某个凭证的拥有者
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-blanton-2008" title="3. Blanton 2008" class="md-nav__link">
    3. Blanton 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1_1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-subscribe" title="Step2. 订阅 (Subscribe)" class="md-nav__link">
    Step2. 订阅 (Subscribe)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3-access" title="Step3. 访问 (Access)" class="md-nav__link">
    Step3. 访问 (Access)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" title="总结" class="md-nav__link">
    总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#amo-2008" title="AMO 2008" class="md-nav__link">
    AMO 2008
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="anonymous-crendials">匿名凭证 (Anonymous Crendials)</h1>
<hr />
<h2 id="1">1. 由来</h2>
<p>一般认为匿名凭证来自上世纪80年代 Chuam 提出的一个构想<sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>，一直到 1999 年，首次出现假名系统<sup id="fnref:2"><a class="footnote-ref" href="#fn:2" rel="footnote">2</a></sup>  (pseudonym system) 这个概念。真正意义上的实现，应该是在 2001 年 Jan Camenisch 等人在欧密会上发表的一篇文章<sup id="fnref:3"><a class="footnote-ref" href="#fn:3" rel="footnote">3</a></sup>，这个方案是基于强RSA假设的。
提出的 anonymous credentials，中文翻译过来即匿名凭证。</p>
<h2 id="2">2 构造</h2>
<h3 id="21-cl-2001">2.1 CL 2001</h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>(1): We give <strong>the first practical solution</strong> that allows a user to unlinkably demonstrate possession of a credential as many times as necessary without involving the issuing organization.</p>
<p>(2): To prevent misuse of anonymoity, our scheme is <strong>the first to offer optional anonymity revocation</strong> for particular transactions.</p>
<p>(3): Our scheme offers <strong>separability</strong>: all organizations can choose their cryptographic keys independently of each other.</p>
</div>
<p>这个构造方案使用了大量的 <strong>零知识证明</strong>。首先，简单说下这里用到的 <strong>零知识证明</strong> 的基本结构:<sup id="fnref:4"><a class="footnote-ref" href="#fn:4" rel="footnote">4</a></sup></p>
<p><span><span class="MathJax_Preview">PK\{(\alpha, \beta, \gamma):y=g^\alpha h^\beta \wedge \tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}\wedge (u\leq \alpha \leq v) \}</span><script type="math/tex">PK\{(\alpha, \beta, \gamma):y=g^\alpha h^\beta \wedge \tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}\wedge (u\leq \alpha \leq v) \}</script></span></p>
<p>这个式子表明对 <span><span class="MathJax_Preview">\alpha, \beta, \gamma</span><script type="math/tex">\alpha, \beta, \gamma</script></span> 满足 <span><span class="MathJax_Preview">y=g^\alpha h^\beta</span><script type="math/tex">y=g^\alpha h^\beta</script></span> 且 <span><span class="MathJax_Preview">\tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}</span><script type="math/tex">\tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}</script></span> 的零知识证明，其中 <span><span class="MathJax_Preview">u\leq \alpha \leq v</span><script type="math/tex">u\leq \alpha \leq v</script></span>。</p>
<p>通过使用 Fiat-Shamir heuristic <sup id="fnref:5"><a class="footnote-ref" href="#fn:5" rel="footnote">5</a></sup>，可以比较容易地将一个 <strong>零知识证明协议</strong> 转换成一个 <strong>签名机制</strong>。可以简单记作： <span><span class="MathJax_Preview">SPK\{(\alpha):y=g^\alpha\}(m)</span><script type="math/tex">SPK\{(\alpha):y=g^\alpha\}(m)</script></span>。</p>
<p>大致有这么三类实体：</p>
<ul>
<li>users （签名者，凭证的使用者，signer）</li>
<li>organizations （用来签发凭证， 也称为 issuer）</li>
<li>verifiers （可以看做服务提供商，service provider）</li>
</ul>
<p>user <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 拥有自己的私钥 <span><span class="MathJax_Preview">x_U</span><script type="math/tex">x_U</script></span>，其从 organization <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 处获得的假名为 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>。</p>
<h4 id="step1">Step1. 初始化</h4>
<p>Organization <span><span class="MathJax_Preview">O_i</span><script type="math/tex">O_i</script></span> 选择 <span><span class="MathJax_Preview">p_{O_i}，q_{O_i}</span><script type="math/tex">p_{O_i}，q_{O_i}</script></span>，并将其作为私钥 <span><span class="MathJax_Preview">SK_{O_i}</span><script type="math/tex">SK_{O_i}</script></span> 保存。然后可以生成公钥 <span><span class="MathJax_Preview">PK_{O_i}:=(n_{O_i},a_{O_i},b_{O_i},d_{O_i},g_{O_i},h_{O_i})</span><script type="math/tex">PK_{O_i}:=(n_{O_i},a_{O_i},b_{O_i},d_{O_i},g_{O_i},h_{O_i})</script></span>。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>公钥 <span><span class="MathJax_Preview">PK_{O_i}</span><script type="math/tex">PK_{O_i}</script></span> 中，除了 <span><span class="MathJax_Preview">n_{O_i}=p_{O_i}q_{O_i}</span><script type="math/tex">n_{O_i}=p_{O_i}q_{O_i}</script></span>，其它四个都是随机生成的。</p>
</div>
<h4 id="step2">Step2. 生成假名</h4>
<p>User <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 可以从 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 那里获取假名 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span> 以及相对应的 tag <span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span>， 其中 <span><span class="MathJax_Preview">P_{(U,O)}=a_O^{x_U}b_O^{s_{(U,O)}}</span><script type="math/tex">P_{(U,O)}=a_O^{x_U}b_O^{s_{(U,O)}}</script></span>。</p>
<p>这里 <span><span class="MathJax_Preview">x_U</span><script type="math/tex">x_U</script></span> 是 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 的私钥，而 <span><span class="MathJax_Preview">s_{(U,O)}</span><script type="math/tex">s_{(U,O)}</script></span> 则是由 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 和 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 共同生成的，但只有 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 知道 <span><span class="MathJax_Preview">s_{(U,O)}</span><script type="math/tex">s_{(U,O)}</script></span> 的值。最后 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 将保存 用户假名 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>，tag <span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span> 以及 <span><span class="MathJax_Preview">P_{(U,O)}^2</span><script type="math/tex">P_{(U,O)}^2</script></span>； <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 将会得到 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>，<span><span class="MathJax_Preview">P_{(U,O)}^2</span><script type="math/tex">P_{(U,O)}^2</script></span>，<span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span> 及 <span><span class="MathJax_Preview">s_{(U,O)}</span><script type="math/tex">s_{(U,O)}</script></span>。</p>
<details class="note"><summary>Protocol 1</summary><ol>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> chooses <span><span class="MathJax_Preview">N_1</span><script type="math/tex">N_1</script></span>，<span><span class="MathJax_Preview">r_1</span><script type="math/tex">r_1</script></span>,<span><span class="MathJax_Preview">r_2,r_3</span><script type="math/tex">r_2,r_3</script></span>, and sets <span><span class="MathJax_Preview">C_1:=g_O^{r_1}h_O^{r_2}, C_2:=g_O^{x_U}h_O^{r_3}</span><script type="math/tex">C_1:=g_O^{r_1}h_O^{r_2}, C_2:=g_O^{x_U}h_O^{r_3}</script></span>. Then <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> sends <span><span class="MathJax_Preview">N_1, C_1, C_2</span><script type="math/tex">N_1, C_1, C_2</script></span> to <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>.</li>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> serves as the prover to verifier <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> in <span><span class="MathJax_Preview">PK\{(\alpha, \beta, \gamma, \delta): C_1^2=(g_O^2)^\alpha (h_O^2)^\beta \wedge C_2^2=(g_O^2)^\gamma (h_O^2)^\delta\}</span><script type="math/tex">PK\{(\alpha, \beta, \gamma, \delta): C_1^2=(g_O^2)^\alpha (h_O^2)^\beta \wedge C_2^2=(g_O^2)^\gamma (h_O^2)^\delta\}</script></span></li>
<li><span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> chooses <span><span class="MathJax_Preview">r, N_2</span><script type="math/tex">r, N_2</script></span>, and sends <span><span class="MathJax_Preview">r, N_2</span><script type="math/tex">r, N_2</script></span> to <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span>.</li>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> sets pseudonym <span><span class="MathJax_Preview">N_{(U,O)}:=N_1||N_2</span><script type="math/tex">N_{(U,O)}:=N_1||N_2</script></span>. <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> computes <span><span class="MathJax_Preview">s_{(U,O)}=(r_1+r_2 mod l')</span><script type="math/tex">s_{(U,O)}=(r_1+r_2 mod l')</script></span>. Then <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> sets the tag <span><span class="MathJax_Preview">P_{(U,O)}:=a_O^{x_U}b_O^{S_{(U,O)}}</span><script type="math/tex">P_{(U,O)}:=a_O^{x_U}b_O^{S_{(U,O)}}</script></span> and sends <span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span> to <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span>.</li>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> proves the values in 4 were chosen correctly by using <span><span class="MathJax_Preview">PK{(...):...}</span><script type="math/tex">PK{(...):...}</script></span></li>
</ol>
</details>
<h4 id="step3">Step3. 生成凭证</h4>
<p>用户可以凭借假名和tag来获取凭证 <span><span class="MathJax_Preview">(c,e)</span><script type="math/tex">(c,e)</script></span>， 并且其满足 <span><span class="MathJax_Preview">P_{(U,O)}d_{O}=c^e</span><script type="math/tex">P_{(U,O)}d_{O}=c^e</script></span>。</p>
<details class="note"><summary>Protocol 2</summary><p>1.
2.
3.</p>
</details>
<h4 id="step4">Step4. 使用凭证</h4>
<p>用户使用一个凭证如 <span><span class="MathJax_Preview">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</span><script type="math/tex">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</script></span>， 并向 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 证明其拥有的凭证是合法的。</p>
<details class="note"><summary>Protocol 3</summary><p>1.
2.</p>
</details>
<h4 id="step5">Step5. 证明其是某个凭证的拥有者</h4>
<p>用户向 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 证明其拥有的凭证 <span><span class="MathJax_Preview">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</span><script type="math/tex">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</script></span> 对应的假名是 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>。</p>
<details class="note"><summary>Protocol 4</summary><p>1.
2.</p>
</details>
<p>此方案可以看做第一个真正意义上实现匿名凭证相关协议的方案。在该方案提出一年后 (2002年)， Camenisch 等人设计出了基于该协议的原型，即 Idmix 系统。这种方案使用了大量的零知识证明，后来的许多方案也延续了这种模式。</p>
<h3 id="3-blanton-2008">3. Blanton 2008</h3>
<p>这篇文章的目的是构造一个匿名获取在线服务的方案，没有直接提及 anonymous credential。此方案使用了<sup id="fnref:6"><a class="footnote-ref" href="#fn:6" rel="footnote">6</a></sup> Camenisch-Lysyanskaya (CL) signature scheme<sup id="fnref:7"><a class="footnote-ref" href="#fn:7" rel="footnote">7</a></sup>，这种签名机制依赖于双线性对 (bilinear pairing)。</p>
<details class="note"><summary>CL-Signature</summary><ol>
<li><strong>KeyGen:</strong> Generate <span><span class="MathJax_Preview">(q,\mathbb{G},\mathbb{G_T},g,e)</span><script type="math/tex">(q,\mathbb{G},\mathbb{G_T},g,e)</script></span>. Choose <span><span class="MathJax_Preview">s,u\leftarrow_R\mathbb{Z_q}</span><script type="math/tex">s,u\leftarrow_R\mathbb{Z_q}</script></span>. Set secret key <span><span class="MathJax_Preview">sk=(s,u)</span><script type="math/tex">sk=(s,u)</script></span>, public key <span><span class="MathJax_Preview">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u)</span><script type="math/tex">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u)</script></span>.</li>
<li><strong>Sign:</strong> For a message <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>, choose <span><span class="MathJax_Preview">\alpha\leftarrow_R\mathbb{Z_R}</span><script type="math/tex">\alpha\leftarrow_R\mathbb{Z_R}</script></span> and set <span><span class="MathJax_Preview">a=g^\alpha</span><script type="math/tex">a=g^\alpha</script></span>. The signature <span><span class="MathJax_Preview">\sigma=(a_1,a_2,a_3)=(a,a^u,a^{s+sum})</span><script type="math/tex">\sigma=(a_1,a_2,a_3)=(a,a^u,a^{s+sum})</script></span>.</li>
<li><strong>Verify:</strong> To verify a signature <span><span class="MathJax_Preview">(a_1,a_2,a_3)</span><script type="math/tex">(a_1,a_2,a_3)</script></span> on message <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>,check:<ul>
<li><span><span class="MathJax_Preview">e(a_1,g^u)=e(a_2,g)</span><script type="math/tex">e(a_1,g^u)=e(a_2,g)</script></span></li>
<li><span><span class="MathJax_Preview">e(a_1,g^s)e(a_2,g^s)^m=e(a_3,g)</span><script type="math/tex">e(a_1,g^s)e(a_2,g^s)^m=e(a_3,g)</script></span></li>
</ul>
</li>
</ol>
</details>
<p>在介绍其具体的机制之前，我们先回顾一下 承诺机制 (commitment scheme):</p>
<ul>
<li>Pedersen Commitment: <span><span class="MathJax_Preview">Com(x,r)=g^xh^r</span><script type="math/tex">Com(x,r)=g^xh^r</script></span> <ul>
<li><mark class="critic">perfectly hiding, computationally binding</mark></li>
</ul>
</li>
<li>ElGamal Commitment: <span><span class="MathJax_Preview">Com(x,r)=(g^xh^r,g^r)</span><script type="math/tex">Com(x,r)=(g^xh^r,g^r)</script></span><ul>
<li><mark class="critic">computationally hiding, perfectly binding</mark></li>
</ul>
</li>
</ul>
<h4 id="step1_1">Step1. 初始化</h4>
<p>服务商 (server) <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 初始一个双线性对 <span><span class="MathJax_Preview">(q,\mathbb{G},\mathbb(G_T),g,e)</span><script type="math/tex">(q,\mathbb{G},\mathbb(G_T),g,e)</script></span>，随机生成 <span><span class="MathJax_Preview">s,u,z_1,z_2,z_3</span><script type="math/tex">s,u,z_1,z_2,z_3</script></span>。那么私钥 <span><span class="MathJax_Preview">sk=(s,u,z_1,z_2,z_3)</span><script type="math/tex">sk=(s,u,z_1,z_2,z_3)</script></span>，公钥为<span><span class="MathJax_Preview">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u,g^{z_1},g^{z_2},g^{z_3})</span><script type="math/tex">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u,g^{z_1},g^{z_2},g^{z_3})</script></span>。</p>
<h4 id="step2-subscribe">Step2. 订阅 (Subscribe)</h4>
<ol>
<li>用户 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 与 服务商 <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 首先协商好服务的类型 (subscriptio type) <span><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> 与 失效的日期 (expiration date) <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>。</li>
<li>用户 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 随机选取 <span><span class="MathJax_Preview">m_U,r</span><script type="math/tex">m_U,r</script></span>，并把对 <span><span class="MathJax_Preview">m_U</span><script type="math/tex">m_U</script></span> 的承诺结果发送给 <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span>，且利用零知识证明其确实拥有 <span><span class="MathJax_Preview">m_U,r</span><script type="math/tex">m_U,r</script></span>。即 <span><span class="MathJax_Preview">PK\{(\alpha,\beta):M=g^\alpha(g^{z_1})^\beta\}</span><script type="math/tex">PK\{(\alpha,\beta):M=g^\alpha(g^{z_1})^\beta\}</script></span>。</li>
<li><span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 选取 <span><span class="MathJax_Preview">m_S</span><script type="math/tex">m_S</script></span>，将其发送给 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span>，并计算 <span><span class="MathJax_Preview">M'=Mg^{mS}</span><script type="math/tex">M'=Mg^{mS}</script></span>。可以看出，<span><span class="MathJax_Preview">M'</span><script type="math/tex">M'</script></span> 就是 <span><span class="MathJax_Preview">m=m_U+m_S</span><script type="math/tex">m=m_U+m_S</script></span>的承诺值。<span><span class="MathJax_Preview">Mg^{m_S}=g^\alpha(g^{z_1})^{\beta}g^{m_S}=g^{m_U+m_S}(g^{z_1})^\beta</span><script type="math/tex">Mg^{m_S}=g^\alpha(g^{z_1})^{\beta}g^{m_S}=g^{m_U+m_S}(g^{z_1})^\beta</script></span></li>
<li><span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 利用 CL-signature，生成对 <span><span class="MathJax_Preview">m,t,d</span><script type="math/tex">m,t,d</script></span>的签名 <span><span class="MathJax_Preview">\sigma=(a_1,a_2,a_3,a_4,a_5,a_6,a_7,a_8,a_9)</span><script type="math/tex">\sigma=(a_1,a_2,a_3,a_4,a_5,a_6,a_7,a_8,a_9)</script></span>。</li>
</ol>
<h4 id="step3-access">Step3. 访问 (Access)</h4>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 需要做的两件事：</p>
<ul>
<li>一是证明 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 确实是对 <span><span class="MathJax_Preview">m,t,d</span><script type="math/tex">m,t,d</script></span> 的合法签名</li>
<li>二是证明 <span><span class="MathJax_Preview">d\geq t_{curr}</span><script type="math/tex">d\geq t_{curr}</script></span></li>
</ul>
<p><span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 需要完成两件事：</p>
<ul>
<li>一是 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 没有被使用过</li>
<li>二是 帮助 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 生成一个新的 token</li>
</ul>
<details class="question"><summary>这里为什么使用零知识证明？</summary><p>为什么不可以直接用验证的方式呢？</p>
</details>
<h4 id="_1">总结</h4>
<p>这个方案虽然只讨论 user 与 server 之间的交互，但由于其具备匿名性等特点，也可以用来构造匿名凭证系统。单纯使用签名机制虽然可以满足可验证性，但是不具备匿名的特点。如果在签名方案的基础上结合零知识证明，可以构造出一个匿名凭证的方案。</p>
<h3 id="amo-2008">AMO 2008</h3>
<p>同样是2008年的文章<sup id="fnref:8"><a class="footnote-ref" href="#fn:8" rel="footnote">8</a></sup>，它是基于</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>D. Chaum, “Security without identification: Transaction systems to make big brother obsolete,” Communications of the ACM, vol. 28, no. 10, pp. 1030–1044, 1985.&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>A. Lysyanskaya, R. L. Rivest, A. Sahai, and S. Wolf, “Pseudonym systems,” in International Workshop on Selected Areas in Cryptography, 1999, pp. 184–199.&#160;<a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>J. Camenisch and A. Lysyanskaya, “An efficient system for non-transferable anonymous credentials with optional anonymity revocation,” in International Conference on the Theory and Applications of Cryptographic Techniques, 2001, pp. 93–118.&#160;<a class="footnote-backref" href="#fnref:3" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>J. Camenisch and M. Stadler, “Efficient group signature schemes for large groups,” in Annual International Cryptology Conference, 1997, pp. 410–424.&#160;<a class="footnote-backref" href="#fnref:4" rev="footnote" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>A. Fiat and A. Shamir, “How to prove yourself: Practical solutions to identification and signature problems,” in Conference on the Theory and Application of Cryptographic Techniques, 1986, pp. 186–194.&#160;<a class="footnote-backref" href="#fnref:5" rev="footnote" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>M. Blanton, “Online subscriptions with anonymous access,” in Proceedings of the 2008 ACM symposium on Information, computer and communications security, 2008, pp. 217–227.&#160;<a class="footnote-backref" href="#fnref:6" rev="footnote" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>J. Camenisch and A. Lysyanskaya, “Signature schemes and anonymous credentials from bilinear maps,” in Annual International Cryptology Conference, 2004, pp. 56–72.&#160;<a class="footnote-backref" href="#fnref:7" rev="footnote" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>N. Akagi, Y. Manabe, and T. Okamoto, “An efficient anonymous credential system,” in International Conference on Financial Cryptography and Data Security, 2008, pp. 272–286.&#160;<a class="footnote-backref" href="#fnref:8" rev="footnote" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ring/" title="环签名" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                环签名
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>