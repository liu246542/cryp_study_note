



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      <script>(function(d){var config = {kitId: 'mtz1zmf',scriptTimeout: 3000,async: true},h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)})(document);</script>
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>匿名凭证 - Liu's Notes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../css/mystyle.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#anonymous-crendials" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Liu's Notes" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Liu's Notes
            </span>
            <span class="md-header-nav__topic">
              匿名凭证
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Liu's Notes" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Liu's Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      密码学
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        密码学
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      对称密码学
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        对称密码学
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../prgf/" title="PRG与PRF" class="md-nav__link">
      PRG与PRF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      数字签名
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        数字签名
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../blind/" title="盲签名" class="md-nav__link">
      盲签名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../group/" title="群签名" class="md-nav__link">
      群签名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ring/" title="环签名" class="md-nav__link">
      环签名
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        匿名凭证
      </label>
    
    <a href="./" title="匿名凭证" class="md-nav__link md-nav__link--active">
      匿名凭证
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" title="1. 由来" class="md-nav__link">
    1. 由来
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2 构造" class="md-nav__link">
    2 构造
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-cl-2001" title="2.1 CL 2001" class="md-nav__link">
    2.1 CL 2001
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2" title="Step2. 生成假名" class="md-nav__link">
    Step2. 生成假名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3" title="Step3. 生成凭证" class="md-nav__link">
    Step3. 生成凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4" title="Step4. 使用凭证" class="md-nav__link">
    Step4. 使用凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step5" title="Step5. 证明其是某个凭证的拥有者" class="md-nav__link">
    Step5. 证明其是某个凭证的拥有者
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-blanton-2008" title="2.2 Blanton 2008" class="md-nav__link">
    2.2 Blanton 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1_1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-subscribe" title="Step2. 订阅 (Subscribe)" class="md-nav__link">
    Step2. 订阅 (Subscribe)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3-access" title="Step3. 访问 (Access)" class="md-nav__link">
    Step3. 访问 (Access)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" title="总结" class="md-nav__link">
    总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-amo-2008" title="2.3 AMO 2008" class="md-nav__link">
    2.3 AMO 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1-issue" title="Step1. Issue" class="md-nav__link">
    Step1. Issue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-prove" title="Step2. Prove" class="md-nav__link">
    Step2. Prove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step1-keygen" title="方案二.Step1. Keygen" class="md-nav__link">
    方案二.Step1. Keygen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-issue" title="方案二.Step2. Issue" class="md-nav__link">
    方案二.Step2. Issue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3-prove" title="方案二.Step3. Prove" class="md-nav__link">
    方案二.Step3. Prove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4-reveal" title="方案二.Step4. Reveal" class="md-nav__link">
    方案二.Step4. Reveal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="总结" class="md-nav__link">
    总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-gs-proof-2008" title="3. GS-proof 2008" class="md-nav__link">
    3. GS-proof 2008
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-p-signature-2008" title="4. P-signature 2008" class="md-nav__link">
    4. P-signature 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1_2" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2_1" title="Step2. 生成密钥" class="md-nav__link">
    Step2. 生成密钥
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3_1" title="Step3. 签名" class="md-nav__link">
    Step3. 签名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4_1" title="Step4. 验证" class="md-nav__link">
    Step4. 验证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-1" title="Special-1. 获取凭证" class="md-nav__link">
    Special-1. 获取凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-2" title="Special-2. 证明" class="md-nav__link">
    Special-2. 证明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-revocation" title="5. Revocation" class="md-nav__link">
    5. Revocation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" title="累加器？" class="md-nav__link">
    累加器？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../accu/" title="累加器" class="md-nav__link">
      累加器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      安全多方计算
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        安全多方计算
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gc/" title="Garbled Circuits" class="md-nav__link">
      Garbled Circuits
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" title="1. 由来" class="md-nav__link">
    1. 由来
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2 构造" class="md-nav__link">
    2 构造
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-cl-2001" title="2.1 CL 2001" class="md-nav__link">
    2.1 CL 2001
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2" title="Step2. 生成假名" class="md-nav__link">
    Step2. 生成假名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3" title="Step3. 生成凭证" class="md-nav__link">
    Step3. 生成凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4" title="Step4. 使用凭证" class="md-nav__link">
    Step4. 使用凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step5" title="Step5. 证明其是某个凭证的拥有者" class="md-nav__link">
    Step5. 证明其是某个凭证的拥有者
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-blanton-2008" title="2.2 Blanton 2008" class="md-nav__link">
    2.2 Blanton 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1_1" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-subscribe" title="Step2. 订阅 (Subscribe)" class="md-nav__link">
    Step2. 订阅 (Subscribe)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3-access" title="Step3. 访问 (Access)" class="md-nav__link">
    Step3. 访问 (Access)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" title="总结" class="md-nav__link">
    总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-amo-2008" title="2.3 AMO 2008" class="md-nav__link">
    2.3 AMO 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1-issue" title="Step1. Issue" class="md-nav__link">
    Step1. Issue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-prove" title="Step2. Prove" class="md-nav__link">
    Step2. Prove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step1-keygen" title="方案二.Step1. Keygen" class="md-nav__link">
    方案二.Step1. Keygen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-issue" title="方案二.Step2. Issue" class="md-nav__link">
    方案二.Step2. Issue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3-prove" title="方案二.Step3. Prove" class="md-nav__link">
    方案二.Step3. Prove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4-reveal" title="方案二.Step4. Reveal" class="md-nav__link">
    方案二.Step4. Reveal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="总结" class="md-nav__link">
    总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-gs-proof-2008" title="3. GS-proof 2008" class="md-nav__link">
    3. GS-proof 2008
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-p-signature-2008" title="4. P-signature 2008" class="md-nav__link">
    4. P-signature 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1_2" title="Step1. 初始化" class="md-nav__link">
    Step1. 初始化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2_1" title="Step2. 生成密钥" class="md-nav__link">
    Step2. 生成密钥
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3_1" title="Step3. 签名" class="md-nav__link">
    Step3. 签名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step4_1" title="Step4. 验证" class="md-nav__link">
    Step4. 验证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-1" title="Special-1. 获取凭证" class="md-nav__link">
    Special-1. 获取凭证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-2" title="Special-2. 证明" class="md-nav__link">
    Special-2. 证明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-revocation" title="5. Revocation" class="md-nav__link">
    5. Revocation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" title="累加器？" class="md-nav__link">
    累加器？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="anonymous-crendials">匿名凭证 (Anonymous Crendials)</h1>
<hr />
<h2 id="1">1. 由来</h2>
<p>一般认为匿名凭证来自上世纪80年代 Chuam 提出的一个构想<sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>，一直到 1999 年，首次出现假名系统<sup id="fnref:2"><a class="footnote-ref" href="#fn:2" rel="footnote">2</a></sup>  (pseudonym system) 这个概念。真正意义上的实现，应该是在 2001 年 Jan Camenisch 等人在欧密会上发表的一篇文章<sup id="fnref:3"><a class="footnote-ref" href="#fn:3" rel="footnote">3</a></sup>，这个方案是基于强RSA假设的。
提出的 anonymous credentials，中文翻译过来即匿名凭证。</p>
<h2 id="2">2 构造</h2>
<h3 id="21-cl-2001">2.1 CL 2001</h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>(1): We give <strong>the first practical solution</strong> that allows a user to unlinkably demonstrate possession of a credential as many times as necessary without involving the issuing organization.</p>
<p>(2): To prevent misuse of anonymoity, our scheme is <strong>the first to offer optional anonymity revocation</strong> for particular transactions.</p>
<p>(3): Our scheme offers <strong>separability</strong>: all organizations can choose their cryptographic keys independently of each other.</p>
</div>
<p>这个构造方案使用了大量的 <strong>零知识证明</strong>。首先，简单说下 <strong>零知识证明</strong> 的基本表示方法:<sup id="fnref:4"><a class="footnote-ref" href="#fn:4" rel="footnote">4</a></sup></p>
<p><span><span class="MathJax_Preview">PK\{(\alpha, \beta, \gamma):y=g^\alpha h^\beta \wedge \tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}\wedge (u\leq \alpha \leq v) \}</span><script type="math/tex">PK\{(\alpha, \beta, \gamma):y=g^\alpha h^\beta \wedge \tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}\wedge (u\leq \alpha \leq v) \}</script></span></p>
<p>这个式子表明对 <span><span class="MathJax_Preview">\alpha, \beta, \gamma</span><script type="math/tex">\alpha, \beta, \gamma</script></span> 满足 <span><span class="MathJax_Preview">y=g^\alpha h^\beta</span><script type="math/tex">y=g^\alpha h^\beta</script></span> 且 <span><span class="MathJax_Preview">\tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}</span><script type="math/tex">\tilde{y}=\tilde{g}^{\alpha}\tilde{h}^{\gamma}</script></span> 的零知识证明，其中 <span><span class="MathJax_Preview">u\leq \alpha \leq v</span><script type="math/tex">u\leq \alpha \leq v</script></span>。</p>
<p>这里的 <span><span class="MathJax_Preview">\alpha, \beta, \gamma</span><script type="math/tex">\alpha, \beta, \gamma</script></span> 就是<strong>知识</strong>，<span><span class="MathJax_Preview">y, g, h</span><script type="math/tex">y, g, h</script></span> 都属于公开的信息。</p>
<p>通过使用 Fiat-Shamir heuristic <sup id="fnref:5"><a class="footnote-ref" href="#fn:5" rel="footnote">5</a></sup>，可以将一个 <strong>零知识证明协议</strong> 转换成一个 <strong>签名机制</strong>。可以简单记作：</p>
<p><span><span class="MathJax_Preview">SPK\{(\alpha):y=g^\alpha\}(m)</span><script type="math/tex">SPK\{(\alpha):y=g^\alpha\}(m)</script></span>。</p>
<details class="question"><summary>如何实现零知识证明：<span><span class="MathJax_Preview">PK\{(\alpha):y=g^\alpha\}</span><script type="math/tex">PK\{(\alpha):y=g^\alpha\}</script></span></summary><ol>
<li><span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> chooses <span><span class="MathJax_Preview">v\leftarrow_R \mathbb{Z}_q^*</span><script type="math/tex">v\leftarrow_R \mathbb{Z}_q^*</script></span>, sends <span><span class="MathJax_Preview">t=g^v</span><script type="math/tex">t=g^v</script></span> to <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>.</li>
<li><span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> chooses <span><span class="MathJax_Preview">c\leftarrow_R \mathbb{Z}_q^*</span><script type="math/tex">c\leftarrow_R \mathbb{Z}_q^*</script></span>, sends <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span> to <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span>.</li>
<li><span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> computes <span><span class="MathJax_Preview">r=v-cx(\mbox{mod}\ q)</span><script type="math/tex">r=v-cx(\mbox{mod}\ q)</script></span>, sends <span><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> to <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>.</li>
<li><span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> accepts iff <span><span class="MathJax_Preview">t=g^ry^c</span><script type="math/tex">t=g^ry^c</script></span>.</li>
</ol>
</details>
<div class="admonition note">
<p class="admonition-title">Fiat-Shamir heuristic</p>
<p>在最初的零知识证明体系中，第二步中的 <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span> 是由 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 选取的。Fiat-Shamir heuristic 的核心就是利用哈希函数让 <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 给出 <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span>，这样可以减少交互次数<sup id="fnref:9"><a class="footnote-ref" href="#fn:9" rel="footnote">9</a></sup>。</p>
<ol>
<li><span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> chooses <span><span class="MathJax_Preview">v\leftarrow_R \mathbb{Z}_q^*</span><script type="math/tex">v\leftarrow_R \mathbb{Z}_q^*</script></span>, computes <span><span class="MathJax_Preview">t=g^v, c=H(t)</span><script type="math/tex">t=g^v, c=H(t)</script></span>.</li>
<li><span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> computes <span><span class="MathJax_Preview">r=v-cx(\mbox{mod}\ q)</span><script type="math/tex">r=v-cx(\mbox{mod}\ q)</script></span>, sends <span><span class="MathJax_Preview">(t,r)</span><script type="math/tex">(t,r)</script></span> to <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>.</li>
</ol>
<p>如果要签名一个消息 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的话，只需要令 <span><span class="MathJax_Preview">c=H(t,m)</span><script type="math/tex">c=H(t,m)</script></span> 即可。</p>
</div>
<p>大致有这么三类实体：</p>
<ul>
<li>users （签名者，凭证的使用者，signer）</li>
<li>organizations （用来签发凭证， 也称为 issuer）</li>
<li>verifiers （可以看做服务提供商，service provider）</li>
</ul>
<p>user <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 拥有自己的私钥 <span><span class="MathJax_Preview">x_U</span><script type="math/tex">x_U</script></span>，其从 organization <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 处获得的假名为 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>。</p>
<h4 id="step1">Step1. 初始化</h4>
<p>Organization <span><span class="MathJax_Preview">O_i</span><script type="math/tex">O_i</script></span> 选择 <span><span class="MathJax_Preview">p_{O_i}，q_{O_i}</span><script type="math/tex">p_{O_i}，q_{O_i}</script></span>，并将其作为私钥 <span><span class="MathJax_Preview">SK_{O_i}</span><script type="math/tex">SK_{O_i}</script></span> 保存。然后可以生成公钥 <span><span class="MathJax_Preview">PK_{O_i}:=(n_{O_i},a_{O_i},b_{O_i},d_{O_i},g_{O_i},h_{O_i})</span><script type="math/tex">PK_{O_i}:=(n_{O_i},a_{O_i},b_{O_i},d_{O_i},g_{O_i},h_{O_i})</script></span>。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>公钥 <span><span class="MathJax_Preview">PK_{O_i}</span><script type="math/tex">PK_{O_i}</script></span> 中，除了 <span><span class="MathJax_Preview">n_{O_i}=p_{O_i}q_{O_i}</span><script type="math/tex">n_{O_i}=p_{O_i}q_{O_i}</script></span>，其它四个都是随机生成的。</p>
</div>
<h4 id="step2">Step2. 生成假名</h4>
<p>User <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 可以从 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 那里获取假名 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span> 以及相对应的 tag <span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span>， 其中 <span><span class="MathJax_Preview">P_{(U,O)}=a_O^{x_U}b_O^{s_{(U,O)}}</span><script type="math/tex">P_{(U,O)}=a_O^{x_U}b_O^{s_{(U,O)}}</script></span>。</p>
<p>这里 <span><span class="MathJax_Preview">x_U</span><script type="math/tex">x_U</script></span> 是 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 的私钥，而 <span><span class="MathJax_Preview">s_{(U,O)}</span><script type="math/tex">s_{(U,O)}</script></span> 则是由 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 和 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 共同生成的，但只有 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 知道 <span><span class="MathJax_Preview">s_{(U,O)}</span><script type="math/tex">s_{(U,O)}</script></span> 的值。最后 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 将保存 用户假名 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>，<span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span> 以及 <span><span class="MathJax_Preview">P_{(U,O)}^2</span><script type="math/tex">P_{(U,O)}^2</script></span>； <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 将会得到 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>，<span><span class="MathJax_Preview">P_{(U,O)}^2</span><script type="math/tex">P_{(U,O)}^2</script></span>，<span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span> 及 <span><span class="MathJax_Preview">s_{(U,O)}</span><script type="math/tex">s_{(U,O)}</script></span>。</p>
<details class="note"><summary>Protocol 1</summary><ol>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> chooses <span><span class="MathJax_Preview">N_1</span><script type="math/tex">N_1</script></span>，<span><span class="MathJax_Preview">r_1</span><script type="math/tex">r_1</script></span>,<span><span class="MathJax_Preview">r_2,r_3</span><script type="math/tex">r_2,r_3</script></span>, and sets <span><span class="MathJax_Preview">C_1:=g_O^{r_1}h_O^{r_2}, C_2:=g_O^{x_U}h_O^{r_3}</span><script type="math/tex">C_1:=g_O^{r_1}h_O^{r_2}, C_2:=g_O^{x_U}h_O^{r_3}</script></span>. Then <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> sends <span><span class="MathJax_Preview">N_1, C_1, C_2</span><script type="math/tex">N_1, C_1, C_2</script></span> to <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>.</li>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> serves as the prover to verifier <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> in <span><span class="MathJax_Preview">PK\{(\alpha, \beta, \gamma, \delta): C_1^2=(g_O^2)^\alpha (h_O^2)^\beta \wedge C_2^2=(g_O^2)^\gamma (h_O^2)^\delta\}</span><script type="math/tex">PK\{(\alpha, \beta, \gamma, \delta): C_1^2=(g_O^2)^\alpha (h_O^2)^\beta \wedge C_2^2=(g_O^2)^\gamma (h_O^2)^\delta\}</script></span></li>
<li><span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> chooses <span><span class="MathJax_Preview">r, N_2</span><script type="math/tex">r, N_2</script></span>, and sends <span><span class="MathJax_Preview">r, N_2</span><script type="math/tex">r, N_2</script></span> to <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span>.</li>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> sets pseudonym <span><span class="MathJax_Preview">N_{(U,O)}:=N_1||N_2</span><script type="math/tex">N_{(U,O)}:=N_1||N_2</script></span>. <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> computes <span><span class="MathJax_Preview">s_{(U,O)}=(r_1+r_2 mod l')</span><script type="math/tex">s_{(U,O)}=(r_1+r_2 mod l')</script></span>. Then <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> sets the tag <span><span class="MathJax_Preview">P_{(U,O)}:=a_O^{x_U}b_O^{S_{(U,O)}}</span><script type="math/tex">P_{(U,O)}:=a_O^{x_U}b_O^{S_{(U,O)}}</script></span> and sends <span><span class="MathJax_Preview">P_{(U,O)}</span><script type="math/tex">P_{(U,O)}</script></span> to <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span>.</li>
<li><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> proves the values in 4 were chosen correctly by using <span><span class="MathJax_Preview">PK{(...):...}</span><script type="math/tex">PK{(...):...}</script></span></li>
</ol>
</details>
<h4 id="step3">Step3. 生成凭证</h4>
<p>用户可以凭借假名和tag来获取凭证 <span><span class="MathJax_Preview">(c,e)</span><script type="math/tex">(c,e)</script></span>， 并且其满足 <span><span class="MathJax_Preview">P_{(U,O)}d_{O}=c^e</span><script type="math/tex">P_{(U,O)}d_{O}=c^e</script></span>。</p>
<details class="note"><summary>Protocol 2</summary><p>1.
2.
3.</p>
</details>
<h4 id="step4">Step4. 使用凭证</h4>
<p>用户使用一个凭证如 <span><span class="MathJax_Preview">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</span><script type="math/tex">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</script></span>， 并向 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 证明其拥有的凭证是合法的。</p>
<details class="note"><summary>Protocol 3</summary><p>1.
2.</p>
</details>
<h4 id="step5">Step5. 证明其是某个凭证的拥有者</h4>
<p>用户向 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 证明其拥有的凭证 <span><span class="MathJax_Preview">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</span><script type="math/tex">(P_{(U,O)},c_{(U,O)},e_{(U,O)})</script></span> 对应的假名是 <span><span class="MathJax_Preview">N_{(U,O)}</span><script type="math/tex">N_{(U,O)}</script></span>。</p>
<details class="note"><summary>Protocol 4</summary><p>1.
2.</p>
</details>
<p>此方案可以看做第一个真正意义上实现匿名凭证相关协议的方案。在该方案提出一年后 (2002年)， Camenisch 等人设计出了基于该协议的原型，即 Idmix 系统。这种方案使用了大量的零知识证明，后来的许多方案也延续了这种模式。</p>
<hr />
<h3 id="22-blanton-2008">2.2 Blanton 2008</h3>
<p>这篇文章<sup id="fnref:6"><a class="footnote-ref" href="#fn:6" rel="footnote">6</a></sup>的目的是构造一个匿名获取在线服务的方案，没有直接提及 anonymous credential。此方案使用了 Camenisch-Lysyanskaya (CL) signature scheme<sup id="fnref:7"><a class="footnote-ref" href="#fn:7" rel="footnote">7</a></sup>，这种签名机制依赖于双线性对 (bilinear pairing)。</p>
<details class="note"><summary>CL-Signature</summary><ol>
<li><strong>KeyGen:</strong> Generate <span><span class="MathJax_Preview">(q,\mathbb{G},\mathbb{G_T},g,e)</span><script type="math/tex">(q,\mathbb{G},\mathbb{G_T},g,e)</script></span>. Choose <span><span class="MathJax_Preview">s,u\leftarrow_R\mathbb{Z_q}</span><script type="math/tex">s,u\leftarrow_R\mathbb{Z_q}</script></span>. Set secret key <span><span class="MathJax_Preview">sk=(s,u)</span><script type="math/tex">sk=(s,u)</script></span>, public key <span><span class="MathJax_Preview">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u)</span><script type="math/tex">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u)</script></span>.</li>
<li><strong>Sign:</strong> For a message <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>, choose <span><span class="MathJax_Preview">\alpha\leftarrow_R\mathbb{Z_R}</span><script type="math/tex">\alpha\leftarrow_R\mathbb{Z_R}</script></span> and set <span><span class="MathJax_Preview">a=g^\alpha</span><script type="math/tex">a=g^\alpha</script></span>. The signature <span><span class="MathJax_Preview">\sigma=(a_1,a_2,a_3)=(a,a^u,a^{s+sum})</span><script type="math/tex">\sigma=(a_1,a_2,a_3)=(a,a^u,a^{s+sum})</script></span>.</li>
<li><strong>Verify:</strong> To verify a signature <span><span class="MathJax_Preview">(a_1,a_2,a_3)</span><script type="math/tex">(a_1,a_2,a_3)</script></span> on message <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>,check:<ul>
<li><span><span class="MathJax_Preview">e(a_1,g^u)=e(a_2,g)</span><script type="math/tex">e(a_1,g^u)=e(a_2,g)</script></span></li>
<li><span><span class="MathJax_Preview">e(a_1,g^s)e(a_2,g^s)^m=e(a_3,g)</span><script type="math/tex">e(a_1,g^s)e(a_2,g^s)^m=e(a_3,g)</script></span></li>
</ul>
</li>
</ol>
</details>
<p>在介绍其具体的机制之前，我们先回顾一下 承诺机制 (commitment scheme):</p>
<ul>
<li>Pedersen Commitment: <span><span class="MathJax_Preview">Com(x,r)=g^xh^r</span><script type="math/tex">Com(x,r)=g^xh^r</script></span> <ul>
<li><mark class="critic">perfectly hiding, computationally binding</mark></li>
</ul>
</li>
<li>ElGamal Commitment: <span><span class="MathJax_Preview">Com(x,r)=(g^xh^r,g^r)</span><script type="math/tex">Com(x,r)=(g^xh^r,g^r)</script></span><ul>
<li><mark class="critic">computationally hiding, perfectly binding</mark></li>
</ul>
</li>
</ul>
<h4 id="step1_1">Step1. 初始化</h4>
<p>服务商 (server) <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 初始一个双线性对 <span><span class="MathJax_Preview">(q,\mathbb{G},\mathbb{G}_T,g,e)</span><script type="math/tex">(q,\mathbb{G},\mathbb{G}_T,g,e)</script></span>，随机生成 <span><span class="MathJax_Preview">s,u,z_1,z_2,z_3</span><script type="math/tex">s,u,z_1,z_2,z_3</script></span>。那么私钥 <span><span class="MathJax_Preview">sk=(s,u,z_1,z_2,z_3)</span><script type="math/tex">sk=(s,u,z_1,z_2,z_3)</script></span>，公钥为<span><span class="MathJax_Preview">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u,g^{z_1},g^{z_2},g^{z_3})</span><script type="math/tex">pk=(q,\mathbb{G},\mathbb{G_T},g,e,g^s,g^u,g^{z_1},g^{z_2},g^{z_3})</script></span>。</p>
<h4 id="step2-subscribe">Step2. 订阅 (Subscribe)</h4>
<ol>
<li>用户 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 与 服务商 <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 首先协商好服务的类型 (subscriptio type) <span><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> 与 失效的日期 (expiration date) <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>。</li>
<li>用户 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 随机选取 <span><span class="MathJax_Preview">m_U,r</span><script type="math/tex">m_U,r</script></span>，并把对 <span><span class="MathJax_Preview">m_U</span><script type="math/tex">m_U</script></span> 的承诺结果发送给 <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span>，且利用零知识证明其确实拥有 <span><span class="MathJax_Preview">m_U,r</span><script type="math/tex">m_U,r</script></span>。即 <span><span class="MathJax_Preview">PK\{(\alpha,\beta):M=g^\alpha(g^{z_1})^\beta\}</span><script type="math/tex">PK\{(\alpha,\beta):M=g^\alpha(g^{z_1})^\beta\}</script></span>。</li>
<li><span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 选取 <span><span class="MathJax_Preview">m_S</span><script type="math/tex">m_S</script></span>，将其发送给 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span>，并计算 <span><span class="MathJax_Preview">M'=Mg^{mS}</span><script type="math/tex">M'=Mg^{mS}</script></span>。可以看出，<span><span class="MathJax_Preview">M'</span><script type="math/tex">M'</script></span> 就是 <span><span class="MathJax_Preview">m=m_U+m_S</span><script type="math/tex">m=m_U+m_S</script></span>的承诺值。<span><span class="MathJax_Preview">Mg^{m_S}=g^\alpha(g^{z_1})^{\beta}g^{m_S}=g^{m_U+m_S}(g^{z_1})^\beta</span><script type="math/tex">Mg^{m_S}=g^\alpha(g^{z_1})^{\beta}g^{m_S}=g^{m_U+m_S}(g^{z_1})^\beta</script></span></li>
<li><span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 利用 CL-signature，生成对 <span><span class="MathJax_Preview">m,t,d</span><script type="math/tex">m,t,d</script></span>的签名 <span><span class="MathJax_Preview">\sigma=(a_1,a_2,a_3,a_4,a_5,a_6,a_7,a_8,a_9)</span><script type="math/tex">\sigma=(a_1,a_2,a_3,a_4,a_5,a_6,a_7,a_8,a_9)</script></span>。</li>
</ol>
<div class="admonition note">
<p class="admonition-title">生成对 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的签名</p>
<p>这里生成对 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的签名，但 <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 实际上并不知道 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的具体内容。但它可以利用 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的承诺值 <span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> 来计算出签名的结果。（盲签名？？）</p>
</div>
<h4 id="step3-access">Step3. 访问 (Access)</h4>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 需要做的两件事：</p>
<ul>
<li>一是证明 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 确实是对 <span><span class="MathJax_Preview">m,t,d</span><script type="math/tex">m,t,d</script></span> 的合法签名</li>
<li>二是证明 <span><span class="MathJax_Preview">d\geq t_{curr}</span><script type="math/tex">d\geq t_{curr}</script></span></li>
</ul>
<p><span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 需要完成两件事：</p>
<ul>
<li>一是 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 没有被使用过</li>
<li>二是 帮助 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 生成一个新的 token</li>
</ul>
<div class="admonition note">
<p class="admonition-title">token</p>
<p>这里的 token 指的就是 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>。<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 只能用一次，每用完一次需要重新生成。而 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 是由 <span><span class="MathJax_Preview">m_U</span><script type="math/tex">m_U</script></span> 与 <span><span class="MathJax_Preview">m_S</span><script type="math/tex">m_S</script></span> 共同组成的，因此这个过程需要与 server 交互。</p>
</div>
<h4 id="_1">总结</h4>
<p>这个方案虽然只讨论 user 与 server 之间的交互，但由于其具备匿名性等特点，也可以用来构造匿名凭证系统。单纯使用签名机制虽然可以满足可验证性，但是不具备匿名的特点。如果在签名方案的基础上结合零知识证明，可以构造出一个匿名凭证的方案。</p>
<hr />
<h3 id="23-amo-2008">2.3 AMO 2008</h3>
<p>同样是2008年的文章<sup id="fnref:8"><a class="footnote-ref" href="#fn:8" rel="footnote">8</a></sup>，它是基于 Okamoto 提出的签名方案<sup id="fnref:12"><a class="footnote-ref" href="#fn:12" rel="footnote">12</a></sup>。</p>
<details class="note"><summary>Okamoto Signature Scheme</summary><p>两个同构的群 <span><span class="MathJax_Preview">\mathbb{G_1},\mathbb{G_2}</span><script type="math/tex">\mathbb{G_1},\mathbb{G_2}</script></span>，且 <span><span class="MathJax_Preview">\psi(g_2)=g_1</span><script type="math/tex">\psi(g_2)=g_1</script></span>。</p>
<p><strong>Setup:</strong> Choose <span><span class="MathJax_Preview">g_2,u_2,v_2\leftarrow_R \mathbb{G_2}</span><script type="math/tex">g_2,u_2,v_2\leftarrow_R \mathbb{G_2}</script></span>，set <span><span class="MathJax_Preview">g_1\leftarrow\psi(g_2),u_1\leftarrow\psi(u_2),v_1\leftarrow\psi(v_2)</span><script type="math/tex">g_1\leftarrow\psi(g_2),u_1\leftarrow\psi(u_2),v_1\leftarrow\psi(v_2)</script></span>; Choose <span><span class="MathJax_Preview">x\leftarrow_R\mathbb{Z}_p^*</span><script type="math/tex">x\leftarrow_R\mathbb{Z}_p^*</script></span> as the private key, <span><span class="MathJax_Preview">w_2=g_2^x</span><script type="math/tex">w_2=g_2^x</script></span> is the public key, public paprameter is <span><span class="MathJax_Preview">(\mathbb{G_1},\mathbb{G_2},\mathbb{G_T}),\psi,e,g_1,g_2,u_2,v_2</span><script type="math/tex">(\mathbb{G_1},\mathbb{G_2},\mathbb{G_T}),\psi,e,g_1,g_2,u_2,v_2</script></span></p>
<p><strong>Sign:</strong> choose <span><span class="MathJax_Preview">r,s\leftarrow_R\mathbb{Z}_p^*</span><script type="math/tex">r,s\leftarrow_R\mathbb{Z}_p^*</script></span>, compute <span><span class="MathJax_Preview">\sigma=(g_1^mu_1v_1^s)^{1/(x+r)}</span><script type="math/tex">\sigma=(g_1^mu_1v_1^s)^{1/(x+r)}</script></span>.</p>
<p><strong>Verify:</strong> check <span><span class="MathJax_Preview">e(\sigma,w_2g_2^r)=e(g_1,g_2^mu_2v_2^s)</span><script type="math/tex">e(\sigma,w_2g_2^r)=e(g_1,g_2^mu_2v_2^s)</script></span></p>
</details>
<hr />
<h4 id="step1-issue">Step1. Issue</h4>
<p>User <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 与 authority <span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 进行交互，其实可以看做是签名的过程。 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 向 <span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 发送了信息 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>，然后收到 <span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 返回的签名 <span><span class="MathJax_Preview">(\sigma,r,s)</span><script type="math/tex">(\sigma,r,s)</script></span>。此签名过程为上面提到的 Okamoto Signature 方案，即 <span><span class="MathJax_Preview">\sigma=(g_1^mu_1v_1^s)^{1/(x+r)}</span><script type="math/tex">\sigma=(g_1^mu_1v_1^s)^{1/(x+r)}</script></span>。</p>
<p>为了方便说明，记 <span><span class="MathJax_Preview">\alpha=w_2g_2^r, \beta=g_2^mu_2v_2^s</span><script type="math/tex">\alpha=w_2g_2^r, \beta=g_2^mu_2v_2^s</script></span>，因此只要验证 <span><span class="MathJax_Preview">e(\sigma,\alpha)=e(g_1,\beta)</span><script type="math/tex">e(\sigma,\alpha)=e(g_1,\beta)</script></span> 是否成立。</p>
<hr />
<h4 id="step2-prove">Step2. Prove</h4>
<p>User <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 与 verifier <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 的交互。那么什么是凭证？</p>
<p>如果把 <span><span class="MathJax_Preview">(\sigma,r,s)</span><script type="math/tex">(\sigma,r,s)</script></span> 看做是 对 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的一个凭证。<span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 要做的就是确保在不告诉 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 的情况下，通过验证。</p>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 首先随机选取两个数 <span><span class="MathJax_Preview">t,\theta\leftarrow_R\mathbb{Z}_p^*</span><script type="math/tex">t,\theta\leftarrow_R\mathbb{Z}_p^*</script></span>，把 <span><span class="MathJax_Preview">(\sigma,\alpha,\beta)</span><script type="math/tex">(\sigma,\alpha,\beta)</script></span> 变成 <span><span class="MathJax_Preview">(\sigma',\alpha',\beta')</span><script type="math/tex">(\sigma',\alpha',\beta')</script></span>，即</p>
<p><span><span class="MathJax_Preview">\sigma'=\sigma^{t/\theta}, \alpha'=\alpha^{\theta}, \beta'=\beta^{t}</span><script type="math/tex">\sigma'=\sigma^{t/\theta}, \alpha'=\alpha^{\theta}, \beta'=\beta^{t}</script></span></p>
<p>然后发送 <span><span class="MathJax_Preview">(\sigma',\alpha',\beta')</span><script type="math/tex">(\sigma',\alpha',\beta')</script></span> 给 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>。</p>
<p>另外， <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 需要使用 ZPK 来证明 <span><span class="MathJax_Preview">\alpha'</span><script type="math/tex">\alpha'</script></span> 确实是 <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> 的 <span><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span> 次方， <span><span class="MathJax_Preview">\beta'</span><script type="math/tex">\beta'</script></span> 是 <span><span class="MathJax_Preview">\beta</span><script type="math/tex">\beta</script></span> 的 <span><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> 次方，即</p>
<p><span><span class="MathJax_Preview">PK\{(\theta,r\theta): \alpha'=w_2^\theta g_2^{r\theta},\theta\neq0\}, PK\{(t,st): \beta'=(g_2^m)^tu_2^gv_2^{st},t\neq0\}</span><script type="math/tex">PK\{(\theta,r\theta): \alpha'=w_2^\theta g_2^{r\theta},\theta\neq0\}, PK\{(t,st): \beta'=(g_2^m)^tu_2^gv_2^{st},t\neq0\}</script></span></p>
<p>这个构造非常简洁，可以保证一些基本的性质 (Unforgeability, Anonymoity, Unlinkability)，但是没有 revocation 。下面给出了提供 <span><span class="MathJax_Preview">Revocation</span><script type="math/tex">Revocation</script></span> 的方案。</p>
<hr />
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>One of the most efficient existing anonymous credential systems is the CamenischLysyanskaya system<sup id="fnref2:7"><a class="footnote-ref" href="#fn:7" rel="footnote">7</a></sup> that is secure under the LRSW assumption for groups with bilinear maps. However, this system lacks a credential revoking protocol.
...</p>
</div>
<p>这篇文章主要着重于 <strong>撤销</strong>，大致把撤销方式分为了两类：</p>
<ul>
<li>Blacklisting</li>
<li>Identity Revealing</li>
</ul>
<p>上面提到的第一个构造方案 (CL 2001) 就是采取 identity revealing，使用 blakclist 的方式最早可见 2007年的这篇文章<sup id="fnref:10"><a class="footnote-ref" href="#fn:10" rel="footnote">10</a></sup>。</p>
<div class="admonition note">
<p class="admonition-title">两种方案的区别</p>
<p>最大的区别在于 ID-Reveal 的方案引入了一个新的第三方 Opener (在CL01<sup id="fnref2:3"><a class="footnote-ref" href="#fn:3" rel="footnote">3</a></sup>这篇文章中称作revocation manager)，这个第三方可以还原出用户的真实身份。</p>
</div>
<details class="hint"><summary>Blacklisting</summary><p>进行验证时，<span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 检查 <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 是否在黑名单列表中，如果是，直接拒绝。</p>
</details>
<details class="hint"><summary>Identity revealing</summary><p><span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 发现了恶意用户时，向 <span><span class="MathJax_Preview">Opener</span><script type="math/tex">Opener</script></span> 提交信息，然后 <span><span class="MathJax_Preview">Opener</span><script type="math/tex">Opener</script></span> 可以还原出用户的 ID，CA 可以通过 ID 废除该用户的公钥。</p>
</details>
<hr />
<h4 id="step1-keygen">方案二.Step1. Keygen</h4>
<p><span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 选择　<span><span class="MathJax_Preview">h,\hat{h},a_2\leftarrow_R\mathbb{G_2}</span><script type="math/tex">h,\hat{h},a_2\leftarrow_R\mathbb{G_2}</script></span>，提供证明　<span><span class="MathJax_Preview">PK\{x:w_2=g_2^x\}</span><script type="math/tex">PK\{x:w_2=g_2^x\}</script></span>　来获取一个证书。</p>
<div class="admonition question">
<p class="admonition-title">向谁证明？</p>
<p>这里获取证书，应该是向 <span><span class="MathJax_Preview">CA</span><script type="math/tex">CA</script></span> 证明</p>
</div>
<p>由于需要带上 revication 的特性，因此 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 和 <span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 都需要自己一对密钥。</p>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 的私钥 <span><span class="MathJax_Preview">sk_U</span><script type="math/tex">sk_U</script></span>为 <span><span class="MathJax_Preview">q\leftarrow_R\mathbb{Z}_p^*</span><script type="math/tex">q\leftarrow_R\mathbb{Z}_p^*</script></span>，公钥 <span><span class="MathJax_Preview">pk_U</span><script type="math/tex">pk_U</script></span> 为 <span><span class="MathJax_Preview">g_2^q</span><script type="math/tex">g_2^q</script></span>。</p>
<p><span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 的私钥为 <span><span class="MathJax_Preview">\xi_1,\xi_2\leftarrow_R\mathbb{Z}_p^*</span><script type="math/tex">\xi_1,\xi_2\leftarrow_R\mathbb{Z}_p^*</script></span>，公钥为 <span><span class="MathJax_Preview">\mathcal{U}=g_2^{\xi_1},\mathcal{V}=g_2^{\xi_2}</span><script type="math/tex">\mathcal{U}=g_2^{\xi_1},\mathcal{V}=g_2^{\xi_2}</script></span>。</p>
<hr />
<h4 id="step2-issue">方案二.Step2. Issue</h4>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 从 <span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 获取凭证，首先对自己的公钥进行签名，发送 <span><span class="MathJax_Preview">(g_2^q,sig_U(g_2^q),m)</span><script type="math/tex">(g_2^q,sig_U(g_2^q),m)</script></span> 给 <span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span>。</p>
<p><span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 使用 <span><span class="MathJax_Preview">g_2^q</span><script type="math/tex">g_2^q</script></span> 验证签名的正确性，并对发送过来的 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 进行签名，得到 <span><span class="MathJax_Preview">(\sigma,r,s)</span><script type="math/tex">(\sigma,r,s)</script></span> 作为 凭证 发送给 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span>。</p>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 只要通过验证 <span><span class="MathJax_Preview">e(\sigma,\alpha)=e(g_1,\beta)</span><script type="math/tex">e(\sigma,\alpha)=e(g_1,\beta)</script></span> 是否成立来判断 凭证的有效性。</p>
<p><span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 就可以把 <span><span class="MathJax_Preview">(\sigma,r,s,m,g_2^q,sig_U(g_2^q))</span><script type="math/tex">(\sigma,r,s,m,g_2^q,sig_U(g_2^q))</script></span> 写入数据库。</p>
<hr />
<h4 id="step3-prove">方案二.Step3. Prove</h4>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 与 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 交互的过程，而且 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 不需直接提供 <span><span class="MathJax_Preview">(\sigma,r,s)</span><script type="math/tex">(\sigma,r,s)</script></span>。</p>
<p>如果是 blacklisting 的模式， <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 都有一份 black list，这里面记录的是用户的公钥，如 <span><span class="MathJax_Preview">\mathsf{BL}=(b_1,b_2,...,b_l)</span><script type="math/tex">\mathsf{BL}=(b_1,b_2,...,b_l)</script></span>， 其中 <span><span class="MathJax_Preview">b_i=g_2^{q_i}</span><script type="math/tex">b_i=g_2^{q_i}</script></span> <span><span class="MathJax_Preview">(1\leq i\leq l)</span><script type="math/tex">(1\leq i\leq l)</script></span>。</p>
<p>与简易版的方案类似，只不过多了一些参数。</p>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 选择 <span><span class="MathJax_Preview">t_1,t_2,\theta,\rho\leftarrow_R\mathbb{Z}_p^*</span><script type="math/tex">t_1,t_2,\theta,\rho\leftarrow_R\mathbb{Z}_p^*</script></span>，<span><span class="MathJax_Preview">f,\hat{f}\leftarrow_R\mathbb{G}_1</span><script type="math/tex">f,\hat{f}\leftarrow_R\mathbb{G}_1</script></span>， 发送 <span><span class="MathJax_Preview">(\sigma',\alpha',\beta',d_1,d_2,\chi,f,\hat{f},g_2^\rho)</span><script type="math/tex">(\sigma',\alpha',\beta',d_1,d_2,\chi,f,\hat{f},g_2^\rho)</script></span> 给 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>，其中</p>
<p><span><span class="MathJax_Preview">\sigma'=\sigma\cdot g_1^{t_1+t_2}, \alpha'=\alpha^\theta, \beta'=\beta^\theta\cdot\alpha'^{t_1+t_2}, d_1=\psi(\mathcal{U})^{t_1}, d_2=\psi(\mathcal{V})^{t_2}, \chi=f^q\hat{f}^\rho</span><script type="math/tex">\sigma'=\sigma\cdot g_1^{t_1+t_2}, \alpha'=\alpha^\theta, \beta'=\beta^\theta\cdot\alpha'^{t_1+t_2}, d_1=\psi(\mathcal{U})^{t_1}, d_2=\psi(\mathcal{V})^{t_2}, \chi=f^q\hat{f}^\rho</script></span></p>
<p>并且需要证明 <span><span class="MathJax_Preview">PK\{(q,\rho,\theta,r\theta,s\theta,t_1,t_2): \chi=f^q\hat{f}^\rho, \alpha'=\alpha^\theta, \beta'=\beta^\theta\cdot\alpha'^{t_1+t_2}, d_1=\psi(\mathcal{U})^{t_1}, d_2=\psi(\mathcal{V})^{t_2}, \theta\neq 0\}</span><script type="math/tex">PK\{(q,\rho,\theta,r\theta,s\theta,t_1,t_2): \chi=f^q\hat{f}^\rho, \alpha'=\alpha^\theta, \beta'=\beta^\theta\cdot\alpha'^{t_1+t_2}, d_1=\psi(\mathcal{U})^{t_1}, d_2=\psi(\mathcal{V})^{t_2}, \theta\neq 0\}</script></span></p>
<hr />
<h4 id="step4-reveal">方案二.Step4. Reveal</h4>
<p><span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 可以通过 <span><span class="MathJax_Preview">(\sigma', d_1, d_2)</span><script type="math/tex">(\sigma', d_1, d_2)</script></span> 来还原 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 的真实身份。</p>
<p>只需要计算 <span><span class="MathJax_Preview">\sigma=\frac{\sigma'}{d_1^{1/\xi_1}d_2^{1/\xi_2}}</span><script type="math/tex">\sigma=\frac{\sigma'}{d_1^{1/\xi_1}d_2^{1/\xi_2}}</script></span>，再通过查找数据库就可以得到 <span><span class="MathJax_Preview">(\sigma, r, s, m, g_2^q, sig_U(g_2^q))</span><script type="math/tex">(\sigma, r, s, m, g_2^q, sig_U(g_2^q))</script></span>。</p>
<p><span><span class="MathJax_Preview">O</span><script type="math/tex">O</script></span> 只需要向 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 证明其身份的有效性：</p>
<p><span><span class="MathJax_Preview">PK\{(\xi_1,\xi_2): \mathcal{U}=g_1^{\xi_1}, \mathcal{V}=g_2^{\xi_2},\sigma=\frac{\sigma'}{d_1^{1/\xi_1}d_2^{1/\xi_2}}\}</span><script type="math/tex">PK\{(\xi_1,\xi_2): \mathcal{U}=g_1^{\xi_1}, \mathcal{V}=g_2^{\xi_2},\sigma=\frac{\sigma'}{d_1^{1/\xi_1}d_2^{1/\xi_2}}\}</script></span></p>
<p>同时 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 也可以验证 <span><span class="MathJax_Preview">(\sigma, r, s, m, g_2^q, sig_U(g_2^q))</span><script type="math/tex">(\sigma, r, s, m, g_2^q, sig_U(g_2^q))</script></span> 的有效性。</p>
<hr />
<h4 id="_2">总结</h4>
<p>这篇文章对凭证的理解， 凭证 可以看做一个签名，然后证明这个凭证是有效的，即 <strong>证明一个签名是有效的</strong>， 这个可以通过 零知识证明的方法。</p>
<p>比如 <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 与 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 进行匿名交涉， <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 向 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 证明拥有某个属性的签名， 如 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span>。</p>
<p>这里需要做的就是把 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 转换成 <span><span class="MathJax_Preview">\sigma'</span><script type="math/tex">\sigma'</script></span>，然后通过零知识证明， 使得 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 相信 <span><span class="MathJax_Preview">\sigma'</span><script type="math/tex">\sigma'</script></span> 的确是由 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 转换过来的。</p>
<p>上面所有提到的 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 可以看做一个属性， 如 <strong>已经大于18岁</strong>， 而 user 要做的就是从 <span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 获取对该属性的签名 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span>， 然后在不直接展示这个签名的情况下， 来证明自己拥有此签名。</p>
<hr />
<h2 id="3-gs-proof-2008">3. GS-proof 2008</h2>
<p>如何有效地完成 <strong>零知识证明</strong> 呢？ 针对这个问题， 2008 年 Groth 与 Sahai 共同提出了一个针对 双线性对的非交互的零知识证明方案<sup id="fnref:13"><a class="footnote-ref" href="#fn:13" rel="footnote">13</a></sup>。Belenkiy， Chase， Kohlweiss，Lysyanskaya 等人在同年利用此方案提出了新的匿名凭证机制<sup id="fnref:14"><a class="footnote-ref" href="#fn:14" rel="footnote">14</a></sup>。</p>
<hr />
<h2 id="4-p-signature-2008">4. P-signature 2008</h2>
<p>基于 GS-proof， Belenkiy 等人构造了 P-signature 的方案<sup id="fnref2:14"><a class="footnote-ref" href="#fn:14" rel="footnote">14</a></sup>。</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>A <strong>P-signature scheme</strong> consists of a signature scheme, a commitment scheme, and </p>
<ol>
<li>an interactive protocol for obtaining a signature on a committed value;</li>
<li>a non-interactive  proof system for proving that the contents of a commitment has been signed;</li>
<li>a non-interactive proof system for proving that a pair of commitments are commitments to the same value.</li>
</ol>
</div>
<!-- 在匿名凭证中最重要的两个协议就是 Issue 和 Prove， -->

<p>P-signature 就是指 </p>
<ol>
<li>在已知 <span><span class="MathJax_Preview">\mathsf{commit}(m)</span><script type="math/tex">\mathsf{commit}(m)</script></span> 的情况下产生一个对 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的签名 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span>；</li>
<li>构建一个对 <span><span class="MathJax_Preview">(\mathsf{commit}(m),\sigma)</span><script type="math/tex">(\mathsf{commit}(m),\sigma)</script></span> 的零知识证明；</li>
<li>证明不同的 <span><span class="MathJax_Preview">\mathsf{commit}(m)</span><script type="math/tex">\mathsf{commit}(m)</script></span> 都对应的同一个值 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>。</li>
</ol>
<hr />
<h3 id="step1_2">Step1. 初始化</h3>
<p><span><span class="MathJax_Preview">\mathsf{SigSetup}(1^k)</span><script type="math/tex">\mathsf{SigSetup}(1^k)</script></span>，生成有关 bilinear pairing 的一系列参数：
<span><span class="MathJax_Preview">(p,G_1,G_2,G_T,e,g,h)</span><script type="math/tex">(p,G_1,G_2,G_T,e,g,h)</script></span>， 令 <span><span class="MathJax_Preview">z=e(g,h)</span><script type="math/tex">z=e(g,h)</script></span>。</p>
<h3 id="step2_1">Step2. 生成密钥</h3>
<p><span><span class="MathJax_Preview">\mathsf{Keygen}(params)</span><script type="math/tex">\mathsf{Keygen}(params)</script></span>，随机选取<span><span class="MathJax_Preview">\alpha,\beta\leftarrow_R\mathbb{Z}_p</span><script type="math/tex">\alpha,\beta\leftarrow_R\mathbb{Z}_p</script></span> 作为私钥， 那么公钥为 <span><span class="MathJax_Preview">(v,w,\tilde{v}),\tilde{w}</span><script type="math/tex">(v,w,\tilde{v}),\tilde{w}</script></span>， 其中
<span><span class="MathJax_Preview">v=h^\alpha,w=h^\beta,\tilde{v}=g^\alpha,\tilde{w}=g^\beta</span><script type="math/tex">v=h^\alpha,w=h^\beta,\tilde{v}=g^\alpha,\tilde{w}=g^\beta</script></span>。</p>
<h3 id="step3_1">Step3. 签名</h3>
<p><span><span class="MathJax_Preview">\mathsf{Sign}(params,(\alpha,\beta),m)</span><script type="math/tex">\mathsf{Sign}(params,(\alpha,\beta),m)</script></span>， 随机选取 <span><span class="MathJax_Preview">r\leftarrow_R\mathbb{Z}_p-\{\frac{\alpha-m}{\beta}\}</span><script type="math/tex">r\leftarrow_R\mathbb{Z}_p-\{\frac{\alpha-m}{\beta}\}</script></span>，计算 <span><span class="MathJax_Preview">C_1=g^{1/(\alpha+m+\beta r)},C_2=w^r,C_3=u^r</span><script type="math/tex">C_1=g^{1/(\alpha+m+\beta r)},C_2=w^r,C_3=u^r</script></span>。</p>
<h3 id="step4_1">Step4. 验证</h3>
<p><span><span class="MathJax_Preview">\mathsf{VerifySig}(params,(v,w,\tilde{v},\tilde{w}),m,(C_1,C_2,C_3))</span><script type="math/tex">\mathsf{VerifySig}(params,(v,w,\tilde{v},\tilde{w}),m,(C_1,C_2,C_3))</script></span>，计算
<span><span class="MathJax_Preview">e(C_1,vh^mC_2)=z, e(u,C_2)=e(C_3,w)</span><script type="math/tex">e(C_1,vh^mC_2)=z, e(u,C_2)=e(C_3,w)</script></span> 是否成立。</p>
<hr />
<p>要利用这个签名机制来完成 P-signature 还需要结合 GS-proof。</p>
<h3 id="special-1">Special-1. 获取凭证</h3>
<p><span><span class="MathJax_Preview">comm\leftarrow\mathsf{Commit}(params,m,open)</span><script type="math/tex">comm\leftarrow\mathsf{Commit}(params,m,open)</script></span></p>
<p><span><span class="MathJax_Preview">\mathsf{ObtainSig}(params,pk,m,comm,open)\leftrightarrow\mathsf{IssueSig}(params,sk,comm)</span><script type="math/tex">\mathsf{ObtainSig}(params,pk,m,comm,open)\leftrightarrow\mathsf{IssueSig}(params,sk,comm)</script></span></p>
<p>简单说下这三个算法，第一个比较简单，user <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 用来生成 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的承诺值 <span><span class="MathJax_Preview">comm</span><script type="math/tex">comm</script></span>。</p>
<p>后两个算法是 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 与 <span><span class="MathJax_Preview">Auth</span><script type="math/tex">Auth</script></span> 交互的过程，可以使用 secure two-party computation 来实现。</p>
<p>通过这个交互， <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 可以获取到关于 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的签名 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span>。</p>
<h3 id="special-2">Special-2. 证明</h3>
<p><span><span class="MathJax_Preview">(comm,\pi,open)\leftarrow\mathsf{Prove}(params,pk,m,\sigma)</span><script type="math/tex">(comm,\pi,open)\leftarrow\mathsf{Prove}(params,pk,m,\sigma)</script></span></p>
<p>User <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 根据 <span><span class="MathJax_Preview">m,\sigma</span><script type="math/tex">m,\sigma</script></span> 来生成关于 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 的零知识证明 <span><span class="MathJax_Preview">\pi</span><script type="math/tex">\pi</script></span>。</p>
<p><span><span class="MathJax_Preview">VerifyProof(params,pk,comm,\pi)</span><script type="math/tex">VerifyProof(params,pk,comm,\pi)</script></span></p>
<p>Verifier <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 根据 <span><span class="MathJax_Preview">\pi</span><script type="math/tex">\pi</script></span> 和 <span><span class="MathJax_Preview">comm</span><script type="math/tex">comm</script></span>，来判断此零知识证明是否有效。</p>
<div class="admonition note">
<p class="admonition-title">匿名凭证是什么？</p>
<p>从这个构造里，我们来勾勒一下匿名凭证的轮廓：</p>
<p>首先，还是三类群体， <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span>，<span><span class="MathJax_Preview">Issuer</span><script type="math/tex">Issuer</script></span>，<span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>。其中 <span><span class="MathJax_Preview">Issuer</span><script type="math/tex">Issuer</script></span> 有一对密钥，并且使用私钥签名，其它群体可以使用公钥进行验证；</p>
<p><span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 如果想要获取某一凭证，可以向 <span><span class="MathJax_Preview">Issuer</span><script type="math/tex">Issuer</script></span> 获取，凭证就是 <span><span class="MathJax_Preview">(\sigma,m)</span><script type="math/tex">(\sigma,m)</script></span> 的一个元组；</p>
<p>如果大家都是诚实的， <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 可以跟 <span><span class="MathJax_Preview">Issuer</span><script type="math/tex">Issuer</script></span> 交互，得到 <span><span class="MathJax_Preview">(\sigma,m)</span><script type="math/tex">(\sigma,m)</script></span>；然后 <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 可以把 <span><span class="MathJax_Preview">(\sigma,m)</span><script type="math/tex">(\sigma,m)</script></span> 递交给 <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span>， <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 可以使用 <span><span class="MathJax_Preview">Issuer</span><script type="math/tex">Issuer</script></span> 的公钥进行验证；</p>
<p>直接这样做的话， <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span> 暴露了太多的信息？ 因此常规的做法是利用 commitment scheme 把 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 转换成 <span><span class="MathJax_Preview">m'</span><script type="math/tex">m'</script></span>，从而利用 <span><span class="MathJax_Preview">m'</span><script type="math/tex">m'</script></span> 来获取一个签名 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span>。这里 <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 是在 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 上的签名。</p>
<p>验证就是为了完成两件事， <span><span class="MathJax_Preview">m'</span><script type="math/tex">m'</script></span> 是 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的一个承诺值； <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 是 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的一个签名。</p>
<p>现在只剩下两个问题， <span><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> 既然不知道 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>， 怎么来断定 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 是否满足某种权限？ <span><span class="MathJax_Preview">Issuer</span><script type="math/tex">Issuer</script></span> 既然也不知道 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>， 怎么能保证 <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> 没有欺骗他？</p>
</div>
<hr />
<h2 id="5-revocation">5. Revocation</h2>
<p>2008年以后，关于 anonymous credentials 的文章开始重点关注 revocation。首先是基于累加器的方案<sup id="fnref:15"><a class="footnote-ref" href="#fn:15" rel="footnote">15</a></sup>。</p>
<h3 id="_3">累加器？</h3>
<p>累加器 (Accumulator)，由 <span><span class="MathJax_Preview">\mathsf{AccGen},\mathsf{AccAdd},\mathsf{AccUpdate},\mathsf{AccWitUpdate},\mathsf{AccVerify}</span><script type="math/tex">\mathsf{AccGen},\mathsf{AccAdd},\mathsf{AccUpdate},\mathsf{AccWitUpdate},\mathsf{AccVerify}</script></span> 这5个算法组成，这些算法由 the accumulator authority， an untrusted update entity， user，verifier 来使用。</p>
<p><span><span class="MathJax_Preview">((sk_A,pk_A),acc_{\phi},state_\phi)\leftarrow\mathsf{AccGen}(1^k,n)</span><script type="math/tex">((sk_A,pk_A),acc_{\phi},state_\phi)\leftarrow\mathsf{AccGen}(1^k,n)</script></span></p>
<p><span><span class="MathJax_Preview">(acc_{V\cup\{i\}},state_{U\cup\{i\}},wit_i)\leftarrow\mathsf{AccAdd}(sk_A,i,acc_V,state_U)</span><script type="math/tex">(acc_{V\cup\{i\}},state_{U\cup\{i\}},wit_i)\leftarrow\mathsf{AccAdd}(sk_A,i,acc_V,state_U)</script></span></p>
<p><span><span class="MathJax_Preview">acc_V\leftarrow\mathsf{AccUpdate}(pk_A,V,state_U)</span><script type="math/tex">acc_V\leftarrow\mathsf{AccUpdate}(pk_A,V,state_U)</script></span></p>
<p><span><span class="MathJax_Preview">wit'_i\leftarrow\mathsf{AccWitUpdate(pk_A,wit_i,V_w,acc_V,V,state_U)}</span><script type="math/tex">wit'_i\leftarrow\mathsf{AccWitUpdate(pk_A,wit_i,V_w,acc_V,V,state_U)}</script></span></p>
<p><span><span class="MathJax_Preview">\mathsf{AccVerify}(pk_A,i,wit_i,acc_V)</span><script type="math/tex">\mathsf{AccVerify}(pk_A,i,wit_i,acc_V)</script></span></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>D. Chaum, “Security without identification: Transaction systems to make big brother obsolete,” Communications of the ACM, vol. 28, no. 10, pp. 1030–1044, 1985.&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>A. Lysyanskaya, R. L. Rivest, A. Sahai, and S. Wolf, “Pseudonym systems,” in International Workshop on Selected Areas in Cryptography, 1999, pp. 184–199.&#160;<a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>J. Camenisch and A. Lysyanskaya, “An efficient system for non-transferable anonymous credentials with optional anonymity revocation,” in International Conference on the Theory and Applications of Cryptographic Techniques, 2001, pp. 93–118.&#160;<a class="footnote-backref" href="#fnref:3" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:3" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>J. Camenisch and M. Stadler, “Efficient group signature schemes for large groups,” in Annual International Cryptology Conference, 1997, pp. 410–424.&#160;<a class="footnote-backref" href="#fnref:4" rev="footnote" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>A. Fiat and A. Shamir, “How to prove yourself: Practical solutions to identification and signature problems,” in Conference on the Theory and Application of Cryptographic Techniques, 1986, pp. 186–194.&#160;<a class="footnote-backref" href="#fnref:5" rev="footnote" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>M. Blanton, “Online subscriptions with anonymous access,” in Proceedings of the 2008 ACM symposium on Information, computer and communications security, 2008, pp. 217–227.&#160;<a class="footnote-backref" href="#fnref:6" rev="footnote" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>J. Camenisch and A. Lysyanskaya, “Signature schemes and anonymous credentials from bilinear maps,” in Annual International Cryptology Conference, 2004, pp. 56–72.&#160;<a class="footnote-backref" href="#fnref:7" rev="footnote" title="Jump back to footnote 7 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:7" rev="footnote" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>N. Akagi, Y. Manabe, and T. Okamoto, “An efficient anonymous credential system,” in International Conference on Financial Cryptography and Data Security, 2008, pp. 272–286.&#160;<a class="footnote-backref" href="#fnref:8" rev="footnote" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:9">
<p>https://www.cs.jhu.edu/~susan/600.641/scribes/lecture11.pdf&#160;<a class="footnote-backref" href="#fnref:9" rev="footnote" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
<li id="fn:10">
<p>P. P. Tsang, M. H. Au, A. Kapadia, and S. W. Smith, “Blacklistable anonymous credentials: blocking misbehaving users without ttps,” in Proceedings of the 14th ACM conference on Computer and communications security, 2007, pp. 72–81.&#160;<a class="footnote-backref" href="#fnref:10" rev="footnote" title="Jump back to footnote 10 in the text">&#8617;</a></p>
</li>
<li id="fn:11">
<p>D. Boneh, X. Boyen, and H. Shacham, “Short group signatures,” in Annual International Cryptology Conference, 2004, pp. 41–55.&#160;<a class="footnote-backref" href="#fnref:11" rev="footnote" title="Jump back to footnote 11 in the text">&#8617;</a></p>
</li>
<li id="fn:12">
<p>T. Okamoto, “Efficient blind and partially blind signatures without random oracles,” in Theory of Cryptography Conference, 2006, pp. 80–99.&#160;<a class="footnote-backref" href="#fnref:12" rev="footnote" title="Jump back to footnote 12 in the text">&#8617;</a></p>
</li>
<li id="fn:13">
<p>J. Groth and A. Sahai, “Efficient non-interactive proof systems for bilinear groups,” in Annual International Conference on the Theory and Applications of Cryptographic Techniques, 2008, pp. 415–432.&#160;<a class="footnote-backref" href="#fnref:13" rev="footnote" title="Jump back to footnote 13 in the text">&#8617;</a></p>
</li>
<li id="fn:14">
<p>M. Belenkiy, M. Chase, M. Kohlweiss, and A. Lysyanskaya, “P-signatures and noninteractive anonymous credentials,” in Theory of Cryptography Conference, 2008, pp. 356–374.&#160;<a class="footnote-backref" href="#fnref:14" rev="footnote" title="Jump back to footnote 14 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:14" rev="footnote" title="Jump back to footnote 14 in the text">&#8617;</a></p>
</li>
<li id="fn:15">
<p>J. Camenisch, M. Kohlweiss, and C. Soriente, “An accumulator based on bilinear maps and efficient revocation for anonymous credentials,” in International Workshop on Public Key Cryptography, 2009, pp. 481–500.&#160;<a class="footnote-backref" href="#fnref:15" rev="footnote" title="Jump back to footnote 15 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ring/" title="环签名" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                环签名
              </span>
            </div>
          </a>
        
        
          <a href="../accu/" title="累加器" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                累加器
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>